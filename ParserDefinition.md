# Loading the generator #

The `lalr.scm` filesdeclares a macro called `lalr-parser`:

```
   (lalr-parser [options] tokens rules ...)
```


This macro, when given appropriate arguments, generates an LALR(1) syntax analyzer. The macro accepts at least two arguments. The first is a list of symbols which represent the terminal symbols of the grammar. The remaining arguments are the grammar production rules. See ParserSyntax for further details.


# Running the parser #

The parser generated by the `lalr-parser` macro is a function that takes two parameters. The first parameter is a lexical analyzer while the second is an error procedure.

## The lexical analyzer ##

The lexical analyzer is zero-argument function (a thunk) invoked each time the parser needs to look-ahead in the token stream. A token is either a symbol, or a record created by the function `make-lexical-token`:

```
   (make-lexical-token category source value)
```

Once the end of file is encountered, the lexical analyzer must always return the symbol `'*eoi*` each time it is invoked.

A lexical token record has three fields: `category`, which must be a symbol, a source location object `source`, and a semantic value associated with the token. For example, a string token would have a category set to `'STRING` while its semantic value is set to the string value `"hello"`. The field accessors are: `lexical-token-category`, `lexical-token-source`, and `lexical-token-value`.

The source location object is not used by the parser itself, but is usually a record constructed by the function `make-source-location`:

```
   (make-source-location input line colum offset length)
```

The `input` argument is an object describing the source input (the name of the input file, for example), while the other arguments give respectively the line number, the column number, the offset (in character) from the beginning of the file, and the length of the token. The field accessors are: `source-location-input`, `source-location-line`, `source-location-column`, `source-location-offset`, and `source-location-length`.

**Note**: It is the responbility of the lexical analyzer to provider the source location information to the parser.


## The error procedure ##

The error procedure must be a function that accepts at least one parameter, the first of which is an error message (a string), while the second, if present, is the lexical token that caused the error.